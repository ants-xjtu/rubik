| NF                                                           | Description                                               | Can Rubik help development? | How can Rubik support it/Why does Rubik not support it       |
| ------------------------------------------------------------ | --------------------------------------------------------- | --------------------------- | ------------------------------------------------------------ |
| Stateless Firewall                                           | Reject traffic from certain hosts/ports                   | Yes                         | **Rubik**: pose the 5-tuple of each packet to the high-level function<br/>**High-level function**: match the 5-tuple and reject the traffic |
| Stateful Firewall                                            | Reject the adversaries with half-connection attacks       | Yes                         | **Rubik**: raise an event of the first and the third handshake of each TCP connection, and pose the connection information to the high-level function.<br/>**High-level function**: Upon the first handshake, maintaining a list that records every newly-recevied SYN and expires those that times out. SYN from the expired host will be dropped for some time; Upon the third handshake, removing the host from list |
| IDS                                                          | Detect malicious content in traffic                       | Yes                         | **Rubik**: pose the reassembled payload to high-level function<br/>**High-level function**: match the payload against a set of rules |
| NAT                                                          | Rewrite packet header between LAN and WAN                 | Yes                         | **Rubik**: pose the source and destination IP address and their pointers of each IP packet to high-level function<br/>**High-level function**: maintain a hash table storing the active mapping from LAN IP address to WAN IP address, rewrite the header of each packet according to the mappings |
| IPS                                                          | Prevent attack on detecting malicious content             | No                          | **Rubik**: pose the reassembled payload to high-level function <br/>**High-level function**: the packets have been sent out when the high-level function can inspect. Therefore, the NF cannot modify or drop the packet |
| HTTP proxy                                                   | Proxy/filter HTTP traffic                                 | No                          | **Rubik**: pose the reassembled payload to high-level function <br/>**High-level function**: The NF can modify L2-L4 header to proxy the traffic, but cannot filter L7 content, e.g. remove ads |
| Inline stream edit [MiddleClick](https://www.diva-portal.org/smash/record.jsf?dswid=1144&pid=diva2%3A1582880&c=1&searchType=SIMPLE&language=en&query=Combined+stateful+classification+and+session+splicing+for+high-speed+NFV+service+chaining&af=%5B%5D&aq=%5B%5B%5D%5D&aq2=%5B%5B%5D%5D&aqe=%5B%5D&noOfRows=50&sortOrder=author_sort_asc&sortOrder2=title_sort_asc&onlyFullText=false&sf=all) | Prevent forwarding packets before stream data is modified | No                          | **Rubik**: To make the sender keep sending packets, the NF must proactively send ACK to collect enough data. However, Rubik currently does not support sending packets |

